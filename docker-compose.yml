services:
  mongo:
    image: mongo:4.4.18
    volumes:
      - ./db:/data/db
    networks:
      - mongodb
    hostname: mongodbserver
    container_name: sylvr-mongodb
    restart: unless-stopped
  proxy:
    image: 'jc21/nginx-proxy-manager:latest'
    ports:
      - '80:80'
      - '81:81'
      - '443:443'
      - '27019:27019'
      - '9229:9229'
    volumes:
      - ./proxy/data:/data
      - ./proxy/letsencrypt:/etc/letsencrypt
      - ./proxy/web:/var/www/html
    networks:
      - sylvrproject
      - mongodb
    container_name: webproxy
    restart: unless-stopped
  livereloadproxy:
    image: 'jc21/nginx-proxy-manager:latest'
    ports:
      - '35729:80'
      - '82:81'
    volumes:
      - ./livereloadproxy/data:/data
      - ./livereloadproxy/letsencrypt:/etc/letsencrypt
      - ./livereloadproxy/web:/var/www/html
    networks:
      - sylvrproject
    container_name: lrproxy
    restart: unless-stopped
  portainer:
    image: portainer/portainer-ce:latest
    volumes:
      - ./portainer:/data
      - /var/run/docker.sock:/var/run/docker.sock
    restart: unless-stopped
    container_name: "portainer"
    networks:
      - sylvrproject
  mongo-express:
    image: mongo-express
    env_file:
      - ./envsetup/mongo-express
    depends_on:
        - mongo
    networks:
      - sylvrproject  
      - mongodb
    container_name: mongoexpress
    restart: unless-stopped

  myhealthopinion:
    build:
      context: myhealthopinion
      target: development
    container_name: myhealthopinion
    stdin_open: true
    volumes:
      - ./myhealthopinion:/usr/src/app
      - /usr/src/app/node_modules
    networks:
      - frequentproject
      - mongodb
    depends_on:
      - mongo
    env_file:
      - ./envsetup/myhealthopinion
    restart: unless-stopped 
  sylver-frontend:
    build:
      context: .Frontend/sylver-frontend
    container_name: sylver-frontend
    stdin_open: true
    volumes:
       - ./sylver-frontend:/usr/src/app
       - /usr/src/app/node_modules
    ports:
      - '3000:3000'
    networks:
      - frequentproject  
      - mongodb

networks:
  frequentproject:
  mongodb: